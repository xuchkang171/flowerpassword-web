
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flower Password (Offline Preserved)</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; background: #f0f2f5; }
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; margin-top: 0; font-size: 24px; display: flex; align-items: center; gap: 10px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; }
        input[type="text"], input[type="password"] { width: 100%; padding: 12px; margin-bottom: 20px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        input:focus { border-color: #3498db; outline: none; }
        .result-group { margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; }
        .result-label { font-size: 12px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .result-value { font-family: "Monaco", "Consolas", monospace; font-size: 18px; color: #333; background: #f8f9fa; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0; word-break: break-all; }
        .note { font-size: 12px; color: #666; margin-top: 30px; line-height: 1.6; background: #fff3cd; padding: 15px; border-radius: 6px; }
        .footer { margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; font-size: 12px; color: #999; line-height: 1.8; }
        .footer a { color: #3498db; text-decoration: none; }
        .footer a:hover { text-decoration: underline; }
        .footer .section { margin-bottom: 10px; }
        .footer strong { color: #666; }
    </style>
</head>
<body>
<div class="card">
    <h1>ğŸŒ¸ Flower Password</h1>

    <label for="password">è®°å¿†å¯†ç  (Master Password)</label>
    <input type="password" id="password" placeholder="è¾“å…¥ä½ çš„è®°å¿†å¯†ç " oninput="calculate()">

    <label for="key">åŒºåˆ†ä»£å· (Key)</label>
    <input type="text" id="key" placeholder="ä¾‹å¦‚ taobao, gmail" oninput="calculate()">

    <div class="result-group">
        <div class="result-label">16ä½ç ï¼ˆæœ€ç»ˆå¯†ç ï¼‰</div>
        <div class="result-value" id="result16"></div>
    </div>

    <div class="result-group">
        <div class="result-label">32ä½å®Œæ•´MD5ç ï¼ˆå†…éƒ¨æºï¼‰</div>
        <div class="result-value" id="result32"></div>
    </div>

    <div class="note">
        <strong>ğŸ”’ ç®—æ³•è¯´æ˜ï¼š</strong><br>
        æ­¤é¡µé¢å®ç°å®˜æ–¹èŠ±å¯†ç®—æ³•ï¼ˆxlsdg/flowerpassword.js v5.0ï¼‰ï¼šHMAC-MD5 + "sunlovesnow1990090127xykab" è§„åˆ™ + é¦–ä½å­—æ¯ä¿æŠ¤ï¼Œæœ¬åœ°è®¡ç®—æ— ç½‘ç»œä¼ è¾“ã€‚
    </div>

    <div class="footer">
        <div class="section">
            <strong>ğŸ“¦ ç®—æ³•æ¥æºï¼š</strong><br>
            â€¢ <a href="https://github.com/xlsdg/flowerpassword.js" target="_blank">xlsdg/flowerpassword.js</a> - JavaScript implementation (MIT License)<br>
            â€¢ <a href="https://github.com/blueimp/JavaScript-MD5" target="_blank">blueimp/JavaScript-MD5</a> - MD5/HMAC-MD5 library (MIT License)
        </div>
        
        <div class="section">
            <strong>ğŸŒ ç›¸å…³èµ„æºï¼š</strong><br>
            â€¢ <a href="https://flowerpassword.com" target="_blank">flowerpassword.com</a> - å®˜æ–¹åœ¨çº¿ç‰ˆ<br>
            â€¢ <a href="https://xlsdg.org/flower-password-windows/" target="_blank">Windows å®¢æˆ·ç«¯</a> - åŸå§‹ Win10 ç‰ˆæœ¬<br>
            â€¢ <a href="https://github.com/xlsdg/flower-password-user-script" target="_blank">æµè§ˆå™¨è„šæœ¬ç‰ˆ</a> - Tampermonkey/Greasemonkey<br>
            â€¢ <a href="https://github.com/xlsdg/flowerpassword.rust" target="_blank">Rust å®ç°</a> - å‘½ä»¤è¡Œç‰ˆæœ¬
        </div>
        
        <div class="section">
            <strong>â„¹ï¸ ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
            èŠ±å¯†æ˜¯ä¸€ç§ç¡®å®šæ€§å¯†ç ç”Ÿæˆæ–¹æ¡ˆï¼Œç›¸åŒçš„"è®°å¿†å¯†ç "å’Œ"åŒºåˆ†ä»£å·"æ€»æ˜¯ç”Ÿæˆç›¸åŒçš„æœ€ç»ˆå¯†ç ã€‚æ— éœ€å­˜å‚¨ï¼Œåªéœ€è®°ä½ä¸€ä¸ªä¸»å¯†ç å³å¯ä¸ºæ‰€æœ‰è´¦æˆ·ç”Ÿæˆç‹¬ç«‹çš„å¼ºå¯†ç ã€‚
        </div>
        
        <div class="section" style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee; color: #aaa;">
            Preserved: 2026-02-02 | Algorithm Version: v5.0.0 | All computation runs locally in your browser
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.19.0/js/md5.min.js"></script>
<script>
function calculate() {
    const password = document.getElementById('password').value;
    const key = document.getElementById('key').value;
    const res16 = document.getElementById('result16');
    const res32 = document.getElementById('result32');

    if (!password || !key) {
        res16.innerText = "";
        res32.innerText = "";
        return;
    }

    // Step 1: Base hash (HMAC-MD5)
    const baseHash = md5(password, key);

    // Step 2: Rule and source hashes with fixed salts
    const ruleHash = md5(baseHash, 'kise');
    const sourceHash = md5(baseHash, 'snow');

    // Step 3: Apply uppercase transformation rules
    const magic = 'sunlovesnow1990090127xykab';
    let result = '';

    for (let i = 0; i < 32; i++) {
        let char = sourceHash[i];
        // If character is a letter AND rule char exists in magic string, uppercase it
        if (isNaN(+char) && magic.includes(ruleHash[i])) {
            char = char.toUpperCase();
        }
        result += char;
    }

    // The 32-bit MD5 (before first-letter rule)
    const md32 = result;

    // Step 4: Apply first-letter rule for final password
    if (!isNaN(+result[0])) {
        result = 'K' + result.slice(1);
    }

    const pass16 = result.slice(0, 16);

    res16.innerText = pass16;
    res32.innerText = md32;
}
</script>
</body>
</html>
